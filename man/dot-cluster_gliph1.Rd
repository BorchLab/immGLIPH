% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clustering.R
\name{.cluster_gliph1}
\alias{.cluster_gliph1}
\title{GLIPH1-style clustering via igraph connected components}
\usage{
.cluster_gliph1(
  clone_network,
  sequences,
  not_in_global_ids,
  seqs,
  vgene.info,
  patient.info,
  global_vgene,
  public_tcrs,
  cluster_min_size,
  verbose
)
}
\arguments{
\item{clone_network}{Data frame. Edge list with columns \code{V1},
\code{V2}, \code{type} (and optionally \code{tag}).}

\item{sequences}{Data frame. Full sample sequences with at least
\code{CDR3b} and optionally \code{TRBV}, \code{patient}.}

\item{not_in_global_ids}{Integer vector. Indices of sequences without
global neighbours (used to add singletons).}

\item{seqs}{Character vector. Unique CDR3b sequences.}

\item{vgene.info}{Logical. Whether V-gene info is available.}

\item{patient.info}{Logical. Whether patient info is available.}

\item{global_vgene}{Logical. Whether global edges require V-gene match.}

\item{public_tcrs}{Logical. If \code{FALSE}, restrict edges to same donor.}

\item{cluster_min_size}{Integer. Minimum cluster size to retain.}

\item{verbose}{Logical. Print progress messages.}
}
\value{
A list with:
\describe{
\item{cluster_properties}{Data frame with cluster_size, tag, members.}
\item{cluster_list}{Named list of data frames (member details).}
\item{clone_network}{Data frame of the final edge list.}
\item{save_cluster_list_df}{Data frame for saving cluster members.}
}
}
\description{
Builds a clone network from local and global edges, optionally filters
by V-gene and donor constraints, constructs an igraph graph, and extracts
connected components as convergence groups. Each component becomes one
cluster named \code{CRG-<first_CDR3b>}.
}
\keyword{internal}
