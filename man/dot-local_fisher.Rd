% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/local-fisher.R
\name{.local_fisher}
\alias{.local_fisher}
\title{Local similarity detection using Fisher's exact test}
\usage{
.local_fisher(
  motif_region,
  refseqs_motif_region,
  seqs,
  refseqs,
  sequences,
  motif_length,
  kmer_mindepth,
  lcminp,
  lcminove,
  discontinuous_motifs,
  motif_distance_cutoff,
  no_cores,
  verbose
)
}
\arguments{
\item{motif_region}{Character vector. Motif regions extracted from sample
sequences (e.g. CDR3b with structural boundaries trimmed).}

\item{refseqs_motif_region}{Character vector. Motif regions extracted from
reference sequences.}

\item{seqs}{Character vector. Unique sample CDR3b sequences.}

\item{refseqs}{Data frame. Reference database containing at least a
\code{CDR3b} column.}

\item{sequences}{Data frame. Sample data containing at least a \code{CDR3b}
column.}

\item{motif_length}{Numeric vector. Lengths of motifs to search for (e.g.
\code{2:4}).}

\item{kmer_mindepth}{Numeric. Minimum number of times a motif must be
observed in the sample set to be considered.}

\item{lcminp}{Numeric. Maximum p-value threshold for a motif to be
considered significant.}

\item{lcminove}{Numeric or numeric vector. Minimum fold change threshold(s)
for enrichment filtering. If a vector, each element corresponds to the
matching entry in \code{motif_length}.}

\item{discontinuous_motifs}{Logical. Whether to include discontinuous motifs
in the search.}

\item{motif_distance_cutoff}{Numeric. Maximum positional distance for motifs
to be grouped together. Not used directly in this function but kept for
interface consistency.}

\item{no_cores}{Numeric. Number of cores to use for parallel motif finding.}

\item{verbose}{Logical. If \code{TRUE}, print status messages via
\code{message()}.}
}
\value{
A list with two elements:
\describe{
\item{selected_motifs}{Data frame of motifs passing significance and
enrichment filters.}
\item{all_motifs}{Data frame of all motifs found in the sample set with
associated statistics.}
}
}
\description{
Implements the GLIPH2-style Fisher's exact test approach for detecting
locally enriched CDR3 motifs in a sample set compared to a reference
database.
}
\keyword{internal}
