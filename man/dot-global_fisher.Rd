% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/global-fisher.R
\name{.global_fisher}
\alias{.global_fisher}
\title{Global similarity search using structural matching and Fisher's test (GLIPH2)}
\usage{
.global_fisher(
  seqs,
  motif_region,
  sequences,
  refseqs,
  refseqs_motif_region,
  structboundaries,
  boundary_size,
  global_vgene,
  all_aa_interchangeable,
  no_cores,
  verbose
)
}
\arguments{
\item{seqs}{Character vector. Unique CDR3b sequences from the sample.}

\item{motif_region}{Character vector. Motif regions of the sample
sequences (boundaries already stripped if applicable).}

\item{sequences}{Data frame. Full sample data frame with at least columns
\code{CDR3b} and (if applicable) \code{TRBV}.}

\item{refseqs}{Data frame. Reference database with at least a \code{CDR3b}
column.}

\item{refseqs_motif_region}{Character vector. Motif regions of the reference
sequences.}

\item{structboundaries}{Logical. Whether structural boundaries are applied.}

\item{boundary_size}{Integer. Number of AAs trimmed from each end.}

\item{global_vgene}{Logical. If \code{TRUE}, restrict edges to pairs sharing
a V-gene.}

\item{all_aa_interchangeable}{Logical. If \code{FALSE}, only pairs whose
variable-position amino acids have BLOSUM62 >= 0 are kept.}

\item{no_cores}{Integer. Number of registered parallel cores.}

\item{verbose}{Logical. Print progress messages.}
}
\value{
A list with elements:
\describe{
\item{cluster_list}{Data frame of struct clusters with columns
\code{cluster_tag}, \code{cluster_size}, \code{unique_CDR3b},
\code{num_in_ref}, \code{fisher.score}, \code{aa_at_position},
\code{TRBV}, \code{CDR3b}.}
\item{global_similarities}{Logical indicating whether any global
similarities were found.}
}
}
\description{
Identifies globally similar CDR3b sequences by generating "struct" tags
(motif region with one variable position replaced by \code{"\%"}), then
testing for enrichment of each struct in the sample set vs. a naive
reference database using the hypergeometric distribution (one-sided
Fisher's exact test). Optionally filters for BLOSUM62-compatible amino
acid substitutions at the variable position.
}
\keyword{internal}
