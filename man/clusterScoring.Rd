% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clusterScoring.R
\name{clusterScoring}
\alias{clusterScoring}
\title{Score CDR3 clusters using the GLIPH or GLIPH2 algorithm}
\usage{
clusterScoring(
  cluster_list,
  cdr3_sequences,
  refdb_beta = "gliph_reference",
  v_usage_freq = NULL,
  cdr3_length_freq = NULL,
  ref_cluster_size = "original",
  gliph_version = 1,
  sim_depth = 1000,
  hla_cutoff = 0.1,
  n_cores = 1
)
}
\arguments{
\item{cluster_list}{A \code{list} where each element contains a
\code{data.frame} of CDR3b sequences and additional information
needed for scoring. Corresponds to the \code{$cluster_list} element
returned by \code{\link{runGLIPH}}.}

\item{cdr3_sequences}{A \code{vector} or \code{data.frame} of CDR3
sequences and optional metadata. The columns must be named as
specified below in arbitrary order:
\itemize{
\item{\code{"CDR3b"}:}{ CDR3 sequences of beta chains.}
\item{\code{"TRBV"}:}{ Optional. V-genes of beta chains.}
\item{\code{"patient"}:}{ Optional. Donor index for the
corresponding sequence, composed of a donor identifier and an
optional experimental condition separated by a colon
(e.g., \code{09/0410:MtbLys}). Only the identifier before the
colon is used for HLA scoring.}
\item{\code{"HLA"}:}{ Optional. Comma-separated HLA alleles for
the corresponding donor in standard notation
(e.g., \code{DPA1*01:03}). Information after the colon in each
allele is ignored during HLA scoring.}
\item{\code{"counts"}:}{ Optional. Clone frequency.}
}}

\item{refdb_beta}{A \code{character} string or \code{data.frame}
specifying the reference database. When a \code{data.frame} is
supplied, CDR3b sequences must be in the first column and V-gene
information (if available) in the second column. The following
keyword may be used to select a built-in database:
\itemize{
\item{\code{"gliph_reference"}:}{ 162,165 CDR3b sequences of
naive human CD4+ or CD8+ T cells from two individuals (GLIPH
publication).}
}
\strong{Default:} \code{"gliph_reference"}}

\item{v_usage_freq}{A \code{data.frame} with V-gene alleles in the
first column and their naive-repertoire frequencies in the second
column. \strong{Default:} \code{NULL}}

\item{cdr3_length_freq}{A \code{data.frame} with CDR3 lengths in the
first column and their naive-repertoire frequencies in the second
column. \strong{Default:} \code{NULL}}

\item{ref_cluster_size}{A \code{character} string defining which
cluster-size probabilities to use for scoring.
\itemize{
\item{\code{"original"}:}{ Standard probabilities from the
original algorithm, constant across sample sizes.}
\item{\code{"simulated"}:}{ Probabilities estimated for different
sample sizes via a 500-step simulation using random sequences
from the reference database.}
}
\strong{Default:} \code{"original"}}

\item{gliph_version}{A \code{numeric} value indicating the algorithm
version.
\itemize{
\item{\code{1}:}{ GLIPH scoring (product of individual scores
multiplied by 0.064).}
\item{\code{2}:}{ GLIPH2 scoring (product of individual scores
only).}
}
\strong{Default:} \code{1}}

\item{sim_depth}{A \code{numeric} value for simulated resampling
depth in non-parametric convergence significance tests. Higher
values increase runtime but improve reproducibility.
\strong{Default:} \code{1000}}

\item{hla_cutoff}{A \code{numeric} threshold below which HLA
probability scores are considered significant.
\strong{Default:} \code{0.1}}

\item{n_cores}{A \code{numeric} value for the number of cores to
use. When \code{NULL}, it is set to the number of available cores
minus two. \strong{Default:} \code{1}}
}
\value{
A \code{data.frame} of cluster scoring results. The first
column contains the total score and additional columns contain up to
five individual scores (cluster size, CDR3 length enrichment, V-gene
enrichment, clonal expansion enrichment, and common HLA enrichment).
}
\description{
Calculates scores for CDR3 clusters following the GLIPH and GLIPH2
scoring procedures. Depending on the information provided, a final
score is computed from up to five cluster properties: cluster size,
enrichment of CDR3 lengths, enrichment of V genes, enrichment of
clonal expansions, and enrichment of common HLA alleles.
}
\examples{
utils::data("gliph_input_data")

res <- runGLIPH(cdr3_sequences = gliph_input_data[seq_len(200), ],
                sim_depth = 100,
                n_cores = 1)

scoring_results <- clusterScoring(
    cluster_list = res$cluster_list,
    cdr3_sequences = gliph_input_data[seq_len(200), ],
    refdb_beta = "gliph_reference",
    gliph_version = 1,
    sim_depth = 100,
    n_cores = 1)

}
\references{
Glanville, Jacob, et al.
"Identifying specificity groups in the T cell receptor repertoire." Nature 547.7661 (2017): 94.

https://github.com/immunoengineer/gliph
}
