% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/local-rrs.R
\name{.local_rrs}
\alias{.local_rrs}
\title{Local similarity detection via repeated random sampling (GLIPH1-style)}
\usage{
.local_rrs(
  motif_region,
  refseqs_motif_region,
  seqs,
  sequences,
  motif_length,
  sim_depth,
  kmer_mindepth,
  lcminp,
  lcminove,
  discontinuous_motifs,
  cdr3_len_stratify,
  vgene_stratify,
  no_cores,
  verbose,
  motif_lengths_list,
  ref_motif_lengths_id_list,
  motif_region_vgenes_list,
  ref_motif_vgenes_id_list,
  lengths_vgenes_list,
  ref_lengths_vgenes_list
)
}
\arguments{
\item{motif_region}{Character vector. Motif regions extracted from sample
sequences.}

\item{refseqs_motif_region}{Character vector. Motif regions extracted from
reference sequences.}

\item{seqs}{Character vector. Unique sample CDR3b sequences.}

\item{sequences}{Data frame. Must contain columns \code{CDR3b} and
\code{TRBV}.}

\item{motif_length}{Numeric vector. Lengths of motifs to search for.}

\item{sim_depth}{Numeric. Number of repeated random sampling iterations.}

\item{kmer_mindepth}{Numeric. Minimum number of times a motif must appear
in the sample set to be considered.}

\item{lcminp}{Numeric. Maximum p-value threshold for a motif to be
selected.}

\item{lcminove}{Numeric vector. Minimum fold-change (observed / expected)
threshold(s). If a single value, the same threshold is applied to all
motif lengths.}

\item{discontinuous_motifs}{Logical. Whether to include discontinuous
motifs.}

\item{cdr3_len_stratify}{Logical. Whether to stratify random subsamples by
CDR3 length distribution.}

\item{vgene_stratify}{Logical. Whether to stratify random subsamples by
V-gene usage distribution.}

\item{no_cores}{Integer. Number of cores for parallel execution.}

\item{verbose}{Logical. If \code{TRUE}, emit progress messages.}

\item{motif_lengths_list}{List. Pre-computed CDR3 length counts from the
sample.}

\item{ref_motif_lengths_id_list}{List. Pre-computed reference indices by
CDR3 length.}

\item{motif_region_vgenes_list}{List. Pre-computed V-gene counts from the
sample.}

\item{ref_motif_vgenes_id_list}{List. Pre-computed reference indices by
V-gene.}

\item{lengths_vgenes_list}{List. Pre-computed joint CDR3-length / V-gene
counts from the sample.}

\item{ref_lengths_vgenes_list}{List. Pre-computed reference indices by
joint CDR3-length / V-gene.}
}
\value{
A list with three elements:
\describe{
\item{sample_log}{Data frame. Rows are \code{"Discovery"} followed by
one row per simulation; columns are motifs. Values are motif counts.}
\item{selected_motifs}{Data frame of motifs passing enrichment filters
with columns \code{motif}, \code{counts}, \code{num_in_ref},
\code{avgRef}, \code{topRef}, \code{OvE}, \code{p.value}.}
\item{all_motifs}{Data frame with the same columns as
\code{selected_motifs} but for every motif found.}
}
}
\description{
Identifies enriched motifs in TCR CDR3b sequences by comparing motif
frequencies in the sample set against repeated random subsamples drawn from
a naive reference database.
}
\keyword{internal}
