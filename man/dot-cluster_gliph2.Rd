% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clustering.R
\name{.cluster_gliph2}
\alias{.cluster_gliph2}
\title{GLIPH2-style clustering by individual motif/struct tags}
\usage{
.cluster_gliph2(
  local_res,
  global_res,
  sequences,
  local_similarities,
  global_similarities,
  global_vgene,
  all_aa_interchangeable,
  structboundaries,
  boundary_size,
  motif_distance_cutoff,
  cluster_min_size,
  boost_local_significance,
  verbose
)
}
\arguments{
\item{local_res}{Data frame. Selected motifs from local enrichment
(must have columns \code{motif}, \code{start}, \code{stop},
\code{num_in_sample}, \code{num_in_ref}, \code{num_fold},
\code{fisher.score}, \code{members}).}

\item{global_res}{Data frame. Global cluster list from
\code{.global_fisher()} (columns: \code{cluster_tag},
\code{cluster_size}, \code{unique_CDR3b}, \code{num_in_ref},
\code{fisher.score}, \code{aa_at_position}, \code{TRBV},
\code{CDR3b}).}

\item{sequences}{Data frame. Full sample data.}

\item{local_similarities}{Logical. Whether local similarities were run.}

\item{global_similarities}{Logical. Whether global similarities were found.}

\item{global_vgene}{Logical. Restrict global edges to matching V-gene.}

\item{all_aa_interchangeable}{Logical. BLOSUM62 filtering.}

\item{structboundaries}{Logical. Whether boundary trimming is active.}

\item{boundary_size}{Integer. Boundary trim size.}

\item{motif_distance_cutoff}{Integer. Max positional distance for
local motifs.}

\item{cluster_min_size}{Integer. Minimum cluster size.}

\item{boost_local_significance}{Logical. Whether to boost local p-values
using germline N-nucleotide information.}

\item{verbose}{Logical. Print progress messages.}
}
\value{
A list with:
\describe{
\item{merged_clusters}{Data frame of cluster properties (type, tag,
cluster_size, unique_cdr3_sample, unique_cdr3_ref, OvE, fisher.score,
members).}
\item{cluster_list}{Named list of data frames with member details.}
\item{clone_network}{Data frame of edges (V1, V2, type, cluster_tag).}
\item{save_cluster_list_df}{Data frame for saving cluster member details.}
}
}
\description{
Each local motif or global struct tag defines its own cluster. Edges are
restricted by motif distance for local connections and by BLOSUM62 for
global connections. Clusters are built as igraph components within each
tag, and enrichment is reassessed per cluster.
}
\keyword{internal}
