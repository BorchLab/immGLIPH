% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/deNovoTCRs.R
\name{deNovoTCRs}
\alias{deNovoTCRs}
\title{Generate de novo TCR sequences}
\usage{
deNovoTCRs(
  convergence_group_tag,
  result_folder = "",
  clustering_output = NULL,
  refdb_beta = "gliph_reference",
  normalization = FALSE,
  accept_sequences_with_C_F_start_end = TRUE,
  sims = 1e+05,
  num_tops = 1000,
  min_length = 10,
  make_figure = FALSE,
  n_cores = 1
)
}
\arguments{
\item{convergence_group_tag}{Character. Tag of the convergence group to
use for prediction.}

\item{result_folder}{Character. Path to the folder containing clustering
output files and where results will be saved. If the value is \code{""},
results are not saved to disk and the clustering output must be provided
via \code{clustering_output}. \strong{Default:} \code{""}}

\item{clustering_output}{List. The output list from \code{turbo_gliph} or
\code{gliph2}. Required when \code{result_folder} is \code{""}.
\strong{Default:} \code{NULL}}

\item{refdb_beta}{Character or data.frame. Specifies the reference
database to use. When a data.frame is provided, the first column should
contain CDR3b sequences and the second column (optional) should contain
V genes. The following keyword can be used to select a built-in
database:
\itemize{
\item \code{"gliph_reference"}: 162,165 CDR3b sequences of naive human
CD4+ or CD8+ T cells from two individuals (GLIPH paper).
}
\strong{Default:} \code{"gliph_reference"}}

\item{normalization}{Logical. If \code{TRUE}, calculated scores are
normalized to the reference database. The returned value represents the
probability that a reference sequence has a score greater than or equal
to the sample sequence score. When V gene information is available, only
sequences with identical V genes are compared.
\strong{Default:} \code{FALSE}}

\item{accept_sequences_with_C_F_start_end}{Logical. If \code{TRUE}, only
sequences beginning with cysteine (C) and ending with phenylalanine (F)
are accepted. \strong{Default:} \code{TRUE}}

\item{sims}{Numeric. Number of de novo CDR3 sequences to generate.
\strong{Default:} \code{100000}}

\item{num_tops}{Numeric. Number of top-scoring de novo sequences to
return. \strong{Default:} \code{1000}}

\item{min_length}{Numeric. Minimum CDR3 sequence length; also determines
the number of N-terminal positions used for PWM scoring.
\strong{Default:} \code{10}}

\item{make_figure}{Logical. Whether to plot the \code{num_tops}
best-scoring de novo sequences as a function of rank.
\strong{Default:} \code{FALSE}}

\item{n_cores}{Numeric. Number of cores for parallel computation. If
\code{NULL}, the number of available cores minus two is used.
\strong{Default:} \code{1}}
}
\value{
A \code{list} with the following elements:
\describe{
\item{de_novo_sequences}{A \code{data.frame} of the \code{num_tops}
best-scoring generated sequences and their corresponding scores.}
\item{sample_sequences_scores}{A \code{data.frame} of the convergence
group sequences and their corresponding scores.}
\item{cdr3_length_probability}{A \code{data.frame} with each observed
CDR3 length and its probability of occurrence in the convergence group.
The length distribution of generated sequences mirrors this
distribution.}
\item{PWM_Scoring}{A \code{data.frame} containing the positional weight
matrix used for scoring. Columns represent amino acids and rows
represent positions relative to the N-terminus.}
\item{PWM_Prediction}{A \code{list} of \code{data.frame}s containing
the positional weight matrices used for sequence generation, one per
observed CDR3 length. Columns represent amino acids and rows represent
positions relative to the N-terminus.}
}
If \code{result_folder} is specified, a tab-delimited file named
\code{<convergence_group_tag>_de_novo.txt} is also written to disk.
}
\description{
De novo generation of CDR3 sequences based on GLIPH or GLIPH2 clustering
results. Using the position-specific abundance of amino acids in the CDR3
region of sequences within a convergence group, artificial sequences are
simulated following the approach established in Glanville et al. The
generated sequences are scored by a positional weight matrix (PWM) derived
from the convergence group, and optionally normalized against a reference
database. The top-scoring sequences are returned.
}
\examples{
\dontrun{
utils::data("gliph_input_data")
res <- runGLIPH(cdr3_sequences = gliph_input_data[seq_len(200),],
  method = "gliph1",
  sim_depth = 100,
  n_cores = 1)

new_seqs <- deNovoTCRs(
  convergence_group_tag = res$cluster_properties$tag[1],
  clustering_output = res,
  sims = 10000,
  make_figure = TRUE,
  n_cores = 1)
}

}
\references{
Glanville, Jacob, et al.
"Identifying specificity groups in the T cell receptor repertoire." Nature 547.7661 (2017): 94.

https://github.com/immunoengineer/gliph
}
